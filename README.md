# wl31 学生信息管理系统

一个基于 Python 和 PyQt5 开发的桌面端学生信息管理系统，支持多角色访问、信息管理、数据分析与批量操作。

## 核心功能

### 管理员 (Admin)
- **用户管理:** 创建、编辑、删除和冻结/解冻教师和学生账户。
- **学生信息管理:** 批量导入、添加、修改、删除和查询学生信息，管理学生电子档案。
- **教师信息管理:** 批量导入、添加、修改、删除和查询教师信息。
- **课程管理:** 创建、编辑和删除课程，并为课程分配授课教师。
- **成绩管理:** 查看和修改所有学生的成绩。
- **数据分析:** 对学生成绩进行多维度查询和统计分析。
- **操作日志:** 查看系统内所有用户的关键操作记录。

### 教师 (Teacher)
- **成绩管理:** 录入和修改其所授课程学生的成绩。
- **数据分析:** 查询其所授课程的成绩，并进行统计分析（如计算平均分、及格率等）。
- **个人信息:** 查看和修改个人密码。

### 学生 (Student)
- **成绩查询:** 查看自己的所有课程成绩。
- **个人信息:** 查看和修改个人密码。

## 技术栈

- **语言:** Python 3
- **GUI框架:** PyQt5
- **数据库:** SQLite 3
- **核心依赖库:**
    - `Pillow`: 用于处理图形验证码。
    - `openpyxl`: 用于读写 Excel 文件。
    - `pypinyin`: 用于将姓名转换为拼音以支持模糊搜索。
    - `numpy`: 用于数据统计分析。

## 如何运行

### 1. 安装依赖

请确保您的 Python 环境已安装以下依赖库。您可以使用 pip 命令一键安装：

```bash
pip install PyQt5 Pillow openpyxl pypinyin numpy
```

### 2. 启动应用

进入项目根目录，执行以下命令启动应用程序：

```bash
python wl31/main.py
```

## 项目结构

```
wl31/
├── main.py                 # 主程序入口和逻辑控制器
├── wl31.db                 # SQLite 数据库文件
├── config.py               # 配置文件 (如数据库路径)
├── database/
│   └── database_manager.py # 数据库交互模块，封装所有SQL操作
├── ui/                       # PyQt UI 定义文件和UI逻辑
├── utils/                    # 工具函数模块 (验证码, 加密, Excel, 拼音)
└── data/                     # 存放静态数据 (如院系专业信息)
```

## 数据库

- **数据库文件:** `wl31/wl31.db`
- **默认管理员账户:**
    - **用户名:** `admin`
    - **密码:** `admin123`

首次运行程序时，如果 `wl31.db` 文件不存在，系统将自动创建并初始化一个包含默认管理员账户的数据库。

## Excel 导入格式

### 学生批量导入

创建 `.xlsx` 文件，数据从第一行开始，**无需表头**。请严格按照以下列顺序填充数据：

| 列 A | 列 B | 列 C | 列 D | 列 E | 列 F | 列 G |
| :--- | :--- | :--- | :--- | :--- | :--- | :--- |
| 学院 | 班级 | 姓名 | 性别 | 入学年份 | 身份证号 | 联系方式 (可选) |

- **默认密码:** 学生的初始登录密码将默认为其 **身份证号的后6位**。
- **用户名/学号:** 学生的用户名将由系统自动生成的学号担任。

### 教师批量导入

创建 `.xlsx` 文件，数据从第一行开始，**无需表头**。请严格按照以下列顺序填充数据：

| 列 A | 列 B | 列 C | 列 D | 列 E | 列 F |
| :--- | :--- | :--- | :--- | :--- | :--- |
| 学院 | 姓名 | 性别 | 职称 | 身份证号 | 联系方式 (可选) |

- **默认密码:** 教师的初始登录密码将默认为其 **身份证号的后6位**。
- **用户名:** 教师的用户名将根据其 **姓名的全拼** 自动生成。如果存在同名，系统会自动在用户名后添加数字以确保唯一性。